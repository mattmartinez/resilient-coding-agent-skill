# External Integrations

**Analysis Date:** 2026-02-18

## APIs & External Services

**Coding Agent CLIs (External Tools):**
- Codex CLI - Executes Codex tasks via `codex exec` with session management
  - Usage: `codex exec --full-auto --json "prompt"` and `codex exec resume <session-id> "continue"`
  - Integration: Direct command invocation in tmux sessions

- Claude Code CLI - Executes Claude tasks via `claude` command
  - Usage: `claude -p "prompt"` and `claude --resume`
  - Integration: Direct command invocation in tmux sessions

- OpenCode CLI - Executes OpenCode tasks via `opencode run`
  - Usage: `opencode run "prompt"` and `opencode run "Continue"`
  - Integration: Direct command invocation in tmux sessions

- Pi Coding Agent - Executes Pi tasks via `pi` command
  - Usage: `pi -p "prompt"` (no native resume; manual restart required)
  - Integration: Direct command invocation in tmux sessions

**ClawHub Registry:**
- Service: Skill/plugin distribution platform
- Purpose: Publish and distribute the resilient-coding-agent skill
- CLI: `clawhub` npm package installed globally in CI workflows
- Auth: `CLAWHUB_TOKEN` GitHub secret for authentication
- Operations:
  - `clawhub login --token $CLAWHUB_TOKEN`
  - `clawhub publish` with version, slug, and metadata

## Data Storage

**Databases:**
- Not applicable - No persistent database integration

**File Storage:**
- **Local Filesystem Only**
  - Secure temp directories created per-task via `mktemp -d`
  - Event logs written to `$TMPDIR/events.jsonl` (Codex only)
  - Session ID files stored at `$TMPDIR/codex-session-id`
  - No cloud storage integration

**Caching:**
- None - Stateless operation per tmux session

## Authentication & Identity

**Auth Providers:**
- None at application level
- CI/CD authentication via GitHub secrets:
  - `CLAWHUB_TOKEN` - Secret for ClawHub API authentication (GitHub Actions environment variable)

**Agent Session Management:**
- Codex: Session ID extracted from event stream and stored locally
- Claude Code: Native session tracking via `claude --resume`
- OpenCode: Native session tracking via resume command
- Pi: No session recovery (manual restart required)

## Monitoring & Observability

**Error Tracking:**
- None - Script-based system with no external error tracking

**Logs:**
- **Approach:** Direct capture via tmux
  - Event logging: `codex exec` outputs JSON events to `$TMPDIR/events.jsonl` (Codex only)
  - Pane capture: `tmux capture-pane` reads up to 120 lines of session output for health monitoring
  - No centralized logging service
  - Scrollback available via `tmux capture-pane -p -S -` (full buffer)

**Health Monitoring:**
- Detection via `tmux has-session` (session existence check)
- Crash detection via output analysis:
  - Shell prompt return (bash `$ `, zsh `% `, fish `> `)
  - Exit indicators (`exit code`, `exited with`, `exit status`)
  - Completion marker (`__TASK_DONE__`)

## CI/CD & Deployment

**Hosting:**
- GitHub (source repository)
- ClawHub Registry (skill distribution)

**CI Pipeline:**
- GitHub Actions (all workflows in `.github/workflows/`)
  - **ci.yml**: Package validation on push and PR
    - Verifies publish directory structure via rsync and `.clawhubignore`
    - Ensures SKILL.md exists and excluded files are absent
  - **clawhub-publish.yml**: Publish skill to ClawHub
    - Triggered by `workflow_dispatch` (manual) or git tags (`v*`)
    - Installs `clawhub@latest` npm package globally
    - Publishes with version, changelog, and tags
  - **release.yml**: Release workflow (referenced but not detailed in exploration)

**Publishing:**
- ClawHub command-line: `clawhub publish /tmp/skill --slug resilient-coding-agent --name "Resilient Coding Agent" --version VERSION --changelog CHANGELOG --tags TAGS`

## Environment Configuration

**Required env vars:**
- `CLAWHUB_TOKEN` - GitHub Actions secret for ClawHub authentication (CI/CD only)
- `TASK_TMPDIR` - Per-task temporary directory path (passed to tmux session via `-e` flag)

**Optional env vars:**
- `CODEX_SESSION_ID` - Extracted and stored in `$TMPDIR/codex-session-id` for resume operations

**Secrets location:**
- GitHub Secrets (`.github/workflows/` access via `${{ secrets.CLAWHUB_TOKEN }}`)
- No `.env` files or local secret storage in codebase

**Secure temp files:**
- Prompt file: `$TMPDIR/prompt` - Written by orchestrator tool (never via shell)
- Session ID file: `$TMPDIR/codex-session-id` - Generated by monitor script from event stream
- Event log: `$TMPDIR/events.jsonl` - Written by Codex CLI
- All temp files in directories with `chmod 700` permissions

## Webhooks & Callbacks

**Incoming:**
- None - Script-based system, no webhook receivers

**Outgoing:**
- **Optional Completion Notifications** (not required):
  - macOS: `osascript` system notifications
  - OpenClaw: `openclaw system event --text "..." --mode now` (fire-and-forget)
  - File markers: `touch $TMPDIR/done` for orchestrator polling
  - All notifications chained with `;` before `echo "__TASK_DONE__"` to preserve completion marker on notification failure

## External Command Invocations

**System utilities (no external network):**
- `tmux` - Session management
- `date` - Timestamp generation
- `sleep` - Retry interval delays
- `grep`, `sed`, `cut` - Text processing
- `printf` - Safe output formatting
- `jq` (optional) - JSON parsing for Codex session ID extraction

---

*Integration audit: 2026-02-18*
